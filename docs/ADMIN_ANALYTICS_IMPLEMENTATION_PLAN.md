# ì–´ë“œë¯¼ ë¶„ì„ ëŒ€ì‹œë³´ë“œ êµ¬í˜„ ê³„íš

> ì‘ì„±ì¼: 2025-01-XX  
> í”„ë¡œì íŠ¸: Clocan (Closet Canvas)  
> ëª©ì : ë°±ì—”ë“œ ë¡œê·¸ ê¸°ë°˜ ì–´ë“œë¯¼ ë¶„ì„ ëŒ€ì‹œë³´ë“œ êµ¬í˜„

---

## ğŸ“‹ ëª©ì°¨

1. [ê°œìš”](#ê°œìš”)
2. [ìš”êµ¬ì‚¬í•­](#ìš”êµ¬ì‚¬í•­)
3. [ê¸°ìˆ  ìŠ¤íƒ](#ê¸°ìˆ -ìŠ¤íƒ)
4. [ì•„í‚¤í…ì²˜ ì„¤ê³„](#ì•„í‚¤í…ì²˜-ì„¤ê³„)
5. [ë°±ì—”ë“œ êµ¬í˜„ ê³„íš](#ë°±ì—”ë“œ-êµ¬í˜„-ê³„íš)
6. [í”„ë¡ íŠ¸ì—”ë“œ êµ¬í˜„ ê³„íš](#í”„ë¡ íŠ¸ì—”ë“œ-êµ¬í˜„-ê³„íš)
7. [ë°ì´í„° êµ¬ì¡°](#ë°ì´í„°-êµ¬ì¡°)
8. [êµ¬í˜„ ë‹¨ê³„](#êµ¬í˜„-ë‹¨ê³„)

---

## ê°œìš”

ë°±ì—”ë“œ ì„œë²„ì˜ ë¡œê·¸ íŒŒì¼ì„ ê¸°ë°˜ìœ¼ë¡œ ì–´ë“œë¯¼ í˜ì´ì§€ì— ë‹¤ìŒ í†µê³„ë¥¼ ì œê³µí•©ë‹ˆë‹¤:

1. **ëœë”© í˜ì´ì§€ ì ‘ì† ìˆ˜ ì£¼ë³„ ì¶”ì´** (í‘œ + ê·¸ë˜í”„)
2. **ìŠ¤íƒ€ì¼ í€´ì¦ˆ ì™„ë£Œ ìˆ˜ ì£¼ë³„ ì¶”ì´** (í‘œ + ê·¸ë˜í”„)
3. **AI ìŠ¤íƒ€ì¼ ë¶„ì„ ì™„ë£Œ ìˆ˜ ì£¼ë³„ ì¶”ì´** (í‘œ + ê·¸ë˜í”„)

### íŠ¹ì§•

- **ì¸ì¦ ì—†ìŒ**: ê³µê°œëœ APIë¡œ ì ‘ê·¼ ê°€ëŠ¥
- **ì‹¤ì‹œê°„ ì§‘ê³„**: API í˜¸ì¶œ ì‹œ ë¡œê·¸ íŒŒì¼ì„ ì½ì–´ì„œ ì§‘ê³„
- **ë¡œê·¸ íŒŒì‹±**: ì •ê·œí‘œí˜„ì‹ì„ ì‚¬ìš©í•œ LogParser í´ë˜ìŠ¤
- **ì£¼ë³„ ë‹¨ìœ„**: ì£¼(Week) ë‹¨ìœ„ë¡œ ë°ì´í„° ì§‘ê³„

---

## ìš”êµ¬ì‚¬í•­

### ê¸°ëŠ¥ ìš”êµ¬ì‚¬í•­

| ID | ê¸°ëŠ¥ | ì„¤ëª… |
|----|------|------|
| **REQ-ADMIN-001** | ëœë”© í˜ì´ì§€ ì ‘ì† ìˆ˜ ì¡°íšŒ | ì£¼ë³„ ëœë”© í˜ì´ì§€ ì ‘ì† ìˆ˜ ì§‘ê³„ |
| **REQ-ADMIN-002** | ìŠ¤íƒ€ì¼ í€´ì¦ˆ ì™„ë£Œ ìˆ˜ ì¡°íšŒ | ì£¼ë³„ ìŠ¤íƒ€ì¼ í€´ì¦ˆ ì™„ë£Œ ìˆ˜ ì§‘ê³„ |
| **REQ-ADMIN-003** | AI ë¶„ì„ ì™„ë£Œ ìˆ˜ ì¡°íšŒ | ì£¼ë³„ AI ìŠ¤íƒ€ì¼ ë¶„ì„ ì™„ë£Œ ìˆ˜ ì§‘ê³„ |
| **REQ-ADMIN-004** | ë¡œê·¸ íŒŒì‹± | ì •ê·œí‘œí˜„ì‹ìœ¼ë¡œ ë¡œê·¸ í•œ ì¤„ íŒŒì‹± |
| **REQ-ADMIN-005** | ì–´ë“œë¯¼ í˜ì´ì§€ UI | í‘œì™€ ê·¸ë˜í”„ë¡œ ë°ì´í„° ì‹œê°í™” |

### ë¹„ê¸°ëŠ¥ ìš”êµ¬ì‚¬í•­

| ID | ìš”êµ¬ì‚¬í•­ | ì„¤ëª… |
|----|---------|------|
| **REQ-ADMIN-NF-001** | ì¸ì¦ ë¶ˆí•„ìš” | ê³µê°œ APIë¡œ ì ‘ê·¼ ê°€ëŠ¥ |
| **REQ-ADMIN-NF-002** | ì„±ëŠ¥ | ë¡œê·¸ íŒŒì¼ ì½ê¸° ìµœì í™” (ìµœê·¼ Nì¼ë§Œ ì½ê¸°) |
| **REQ-ADMIN-NF-003** | ì—ëŸ¬ ì²˜ë¦¬ | ë¡œê·¸ íŒŒì¼ì´ ì—†ê±°ë‚˜ ì½ì„ ìˆ˜ ì—†ì„ ë•Œ ì²˜ë¦¬ |

---

## ê¸°ìˆ  ìŠ¤íƒ

### ë°±ì—”ë“œ

- **Spring Boot 3.2.0**
- **Java 17**
- **ì •ê·œí‘œí˜„ì‹**: `java.util.regex.Pattern`
- **íŒŒì¼ I/O**: `java.nio.file.Files`

### í”„ë¡ íŠ¸ì—”ë“œ

- **Next.js 15.0**
- **React 19.0**
- **TypeScript**
- **Recharts** (ì´ë¯¸ ì„¤ì¹˜ë¨) - ì°¨íŠ¸ ë¼ì´ë¸ŒëŸ¬ë¦¬
- **shadcn/ui** - UI ì»´í¬ë„ŒíŠ¸

---

## ì•„í‚¤í…ì²˜ ì„¤ê³„

### ì „ì²´ íë¦„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ì–´ë“œë¯¼ í˜ì´ì§€   â”‚
â”‚  /admin/analyticsâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ HTTP GET
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Analytics API   â”‚
â”‚  /api/v1/admin/ â”‚
â”‚  analytics/*    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  LogParser       â”‚
â”‚  (ì •ê·œí‘œí˜„ì‹)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  LogFileReader  â”‚
â”‚  (ë¡œê·¸ íŒŒì¼ ì½ê¸°)â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  logs/          â”‚
â”‚  application.logâ”‚
â”‚  api-requests.logâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ë°ì´í„° íë¦„

1. **í”„ë¡ íŠ¸ì—”ë“œ**: ì–´ë“œë¯¼ í˜ì´ì§€ì—ì„œ API í˜¸ì¶œ
2. **ë°±ì—”ë“œ**: ë¡œê·¸ íŒŒì¼ ì½ê¸°
3. **ë°±ì—”ë“œ**: LogParserë¡œ ê° ì¤„ íŒŒì‹±
4. **ë°±ì—”ë“œ**: ì£¼ë³„ë¡œ ì§‘ê³„
5. **ë°±ì—”ë“œ**: JSON ì‘ë‹µ ë°˜í™˜
6. **í”„ë¡ íŠ¸ì—”ë“œ**: í‘œì™€ ê·¸ë˜í”„ë¡œ í‘œì‹œ

---

## ë°±ì—”ë“œ êµ¬í˜„ ê³„íš

### 1. LogParser í´ë˜ìŠ¤

**ìœ„ì¹˜**: `backend/src/main/java/com/example/wardrobe/common/logging/LogParser.java`

**ì—­í• **: ë¡œê·¸ í•œ ì¤„ì„ íŒŒì‹±í•˜ì—¬ êµ¬ì¡°í™”ëœ ë°ì´í„° ì¶”ì¶œ

**íŒŒì‹±í•  ì •ë³´**:
- `requestId`: ULID ë˜ëŠ” UUID
- `timestamp`: ë¡œê·¸ íƒ€ì„ìŠ¤íƒ¬í”„
- `method`: HTTP ë©”ì„œë“œ (GET, POST ë“±)
- `apiPath`: API ê²½ë¡œ (ì˜ˆ: `/api/v1/feature1/ping`)
- `referer`: Referer í—¤ë” (í”„ë¡ íŠ¸ì—”ë“œ í˜ì´ì§€ ì •ë³´)

**ë¡œê·¸ í˜•ì‹ ì˜ˆì‹œ**:

```
ë°±ì—”ë“œ ë¡œê·¸ (application.log):
2025-01-20 15:30:45.123 INFO  [01AN4Z07BY79K3] --- [http-nio-8080-exec-1] c.e.w.common.logging.ApiLogger : API Request: GET /api/v1/feature1/ping | RequestId: 01AN4Z07BY79K3

í”„ë¡ íŠ¸ì—”ë“œ ë¡œê·¸ (ë¸Œë¼ìš°ì € ì½˜ì†” â†’ ë°±ì—”ë“œë¡œ ì „ì†¡ ì‹œ):
[2025-01-20T15:30:45.123Z][FE][INFO][Feature1] REQUEST_START { requestId: "550e8400-...", url: "https://..." }
```

**ì •ê·œí‘œí˜„ì‹ íŒ¨í„´**:

```java
// ë°±ì—”ë“œ ë¡œê·¸ íŒ¨í„´
private static final Pattern BACKEND_LOG_PATTERN = Pattern.compile(
    "^(\\d{4}-\\d{2}-\\d{2} \\d{2}:\\d{2}:\\d{2}\\.\\d{3}) " +  // timestamp
    "(INFO|DEBUG|ERROR|WARN) " +                                 // level
    "\\[([A-Z0-9]+)\\] " +                                       // requestId (ULID)
    ".*?API Request: (GET|POST|PUT|DELETE) " +                  // method
    "([^|]+)" +                                                   // apiPath
    ".*?RequestId: ([A-Z0-9]+)"                                   // requestId í™•ì¸
);

// í”„ë¡ íŠ¸ì—”ë“œ ë¡œê·¸ íŒ¨í„´ (ë°±ì—”ë“œë¡œ ì „ì†¡ëœ ê²½ìš°)
private static final Pattern FRONTEND_LOG_PATTERN = Pattern.compile(
    "\\[([^]]+)\\]" +                                            // timestamp
    "\\[FE\\]" +
    "\\[([^]]+)\\]" +                                             // level
    "\\[([^]]+)\\]" +                                             // scope
    " ([A-Z_]+)" +                                                // event
    ".*?requestId[:\"\\s]+([A-Za-z0-9-]+)" +                     // requestId
    ".*?url[:\"\\s]+([^\\s}]+)"                                  // url
);
```

**í´ë˜ìŠ¤ êµ¬ì¡°**:

```java
public class LogParser {
    
    public static class ParsedLog {
        private String requestId;
        private LocalDateTime timestamp;
        private String method;
        private String apiPath;
        private String referer;
        private String logType; // "backend" | "frontend"
        
        // getters, setters, constructor
    }
    
    /**
     * ë¡œê·¸ í•œ ì¤„ì„ íŒŒì‹±
     * 
     * @param logLine ë¡œê·¸ í•œ ì¤„
     * @return ParsedLog ê°ì²´ (íŒŒì‹± ì‹¤íŒ¨ ì‹œ null)
     */
    public static ParsedLog parse(String logLine) {
        // ë°±ì—”ë“œ ë¡œê·¸ íŒ¨í„´ ë§¤ì¹­ ì‹œë„
        Matcher backendMatcher = BACKEND_LOG_PATTERN.matcher(logLine);
        if (backendMatcher.matches()) {
            return parseBackendLog(backendMatcher);
        }
        
        // í”„ë¡ íŠ¸ì—”ë“œ ë¡œê·¸ íŒ¨í„´ ë§¤ì¹­ ì‹œë„
        Matcher frontendMatcher = FRONTEND_LOG_PATTERN.matcher(logLine);
        if (frontendMatcher.matches()) {
            return parseFrontendLog(frontendMatcher);
        }
        
        return null; // íŒŒì‹± ì‹¤íŒ¨
    }
    
    private static ParsedLog parseBackendLog(Matcher matcher) {
        // ê·¸ë£¹ ì¶”ì¶œ ë° ParsedLog ê°ì²´ ìƒì„±
    }
    
    private static ParsedLog parseFrontendLog(Matcher matcher) {
        // ê·¸ë£¹ ì¶”ì¶œ ë° ParsedLog ê°ì²´ ìƒì„±
        // URLì—ì„œ API ê²½ë¡œ ì¶”ì¶œ
    }
}
```

---

### 2. AnalyticsService í´ë˜ìŠ¤

**ìœ„ì¹˜**: `backend/src/main/java/com/example/wardrobe/service/AnalyticsService.java`

**ì—­í• **: ë¡œê·¸ íŒŒì¼ ì½ê¸° ë° ì§‘ê³„ ë¡œì§

**ì£¼ìš” ë©”ì„œë“œ**:

```java
@Service
public class AnalyticsService {
    
    /**
     * ëœë”© í˜ì´ì§€ ì ‘ì† ìˆ˜ ì£¼ë³„ ì§‘ê³„
     * 
     * @param weeks ì¡°íšŒí•  ì£¼ ìˆ˜ (ê¸°ë³¸ê°’: 12ì£¼)
     * @return ì£¼ë³„ ì ‘ì† ìˆ˜ ë¦¬ìŠ¤íŠ¸
     */
    public List<WeeklyAnalytics> getLandingPageViews(int weeks) {
        // ë¡œê·¸ íŒŒì¼ ì½ê¸°
        // LogParserë¡œ íŒŒì‹±
        // ëœë”© í˜ì´ì§€ ê´€ë ¨ ë¡œê·¸ í•„í„°ë§ (refererê°€ "/" ë˜ëŠ” page_view ì´ë²¤íŠ¸)
        // ì£¼ë³„ë¡œ ì§‘ê³„
    }
    
    /**
     * ìŠ¤íƒ€ì¼ í€´ì¦ˆ ì™„ë£Œ ìˆ˜ ì£¼ë³„ ì§‘ê³„
     * 
     * @param weeks ì¡°íšŒí•  ì£¼ ìˆ˜
     * @return ì£¼ë³„ ì™„ë£Œ ìˆ˜ ë¦¬ìŠ¤íŠ¸
     */
    public List<WeeklyAnalytics> getQuizCompletions(int weeks) {
        // ë¡œê·¸ íŒŒì¼ ì½ê¸°
        // LogParserë¡œ íŒŒì‹±
        // quiz_complete ì´ë²¤íŠ¸ í•„í„°ë§
        // ì£¼ë³„ë¡œ ì§‘ê³„
    }
    
    /**
     * AI ë¶„ì„ ì™„ë£Œ ìˆ˜ ì£¼ë³„ ì§‘ê³„
     * 
     * @param weeks ì¡°íšŒí•  ì£¼ ìˆ˜
     * @return ì£¼ë³„ ì™„ë£Œ ìˆ˜ ë¦¬ìŠ¤íŠ¸
     */
    public List<WeeklyAnalytics> getAnalysisCompletions(int weeks) {
        // ë¡œê·¸ íŒŒì¼ ì½ê¸°
        // LogParserë¡œ íŒŒì‹±
        // result_generated ì´ë²¤íŠ¸ í•„í„°ë§
        // ì£¼ë³„ë¡œ ì§‘ê³„
    }
    
    /**
     * ë¡œê·¸ íŒŒì¼ ì½ê¸° (ìµœê·¼ Nì¼ë§Œ)
     * 
     * @param days ìµœê·¼ ë©°ì¹ ì¹˜ ë¡œê·¸ ì½ê¸°
     * @return ë¡œê·¸ ë¼ì¸ ë¦¬ìŠ¤íŠ¸
     */
    private List<String> readLogFiles(int days) {
        // logs/application.log ì½ê¸°
        // logs/api-requests.log ì½ê¸°
        // ìµœê·¼ Nì¼ì¹˜ë§Œ í•„í„°ë§
    }
}
```

---

### 3. AnalyticsController í´ë˜ìŠ¤

**ìœ„ì¹˜**: `backend/src/main/java/com/example/wardrobe/controller/AnalyticsController.java`

**ì—­í• **: REST API ì—”ë“œí¬ì¸íŠ¸ ì œê³µ

**ì—”ë“œí¬ì¸íŠ¸**:

```java
@RestController
@RequestMapping("/api/v1/admin/analytics")
public class AnalyticsController {
    
    private final AnalyticsService analyticsService;
    
    /**
     * ëœë”© í˜ì´ì§€ ì ‘ì† ìˆ˜ ì¡°íšŒ
     * GET /api/v1/admin/analytics/landing-page-views
     * 
     * @param weeks ì¡°íšŒí•  ì£¼ ìˆ˜ (ê¸°ë³¸ê°’: 12)
     * @return ì£¼ë³„ ì ‘ì† ìˆ˜ ë°ì´í„°
     */
    @GetMapping("/landing-page-views")
    public ResponseEntity<List<WeeklyAnalyticsResponse>> getLandingPageViews(
        @RequestParam(defaultValue = "12") int weeks
    ) {
        // ì¸ì¦ ë¶ˆí•„ìš” (ê³µê°œ API)
        List<WeeklyAnalytics> data = analyticsService.getLandingPageViews(weeks);
        return ResponseEntity.ok(toResponse(data));
    }
    
    /**
     * ìŠ¤íƒ€ì¼ í€´ì¦ˆ ì™„ë£Œ ìˆ˜ ì¡°íšŒ
     * GET /api/v1/admin/analytics/quiz-completions
     */
    @GetMapping("/quiz-completions")
    public ResponseEntity<List<WeeklyAnalyticsResponse>> getQuizCompletions(
        @RequestParam(defaultValue = "12") int weeks
    ) {
        List<WeeklyAnalytics> data = analyticsService.getQuizCompletions(weeks);
        return ResponseEntity.ok(toResponse(data));
    }
    
    /**
     * AI ë¶„ì„ ì™„ë£Œ ìˆ˜ ì¡°íšŒ
     * GET /api/v1/admin/analytics/analysis-completions
     */
    @GetMapping("/analysis-completions")
    public ResponseEntity<List<WeeklyAnalyticsResponse>> getAnalysisCompletions(
        @RequestParam(defaultValue = "12") int weeks
    ) {
        List<WeeklyAnalytics> data = analyticsService.getAnalysisCompletions(weeks);
        return ResponseEntity.ok(toResponse(data));
    }
}
```

**Security ì„¤ì •**: ì¸ì¦ ë¶ˆí•„ìš”í•˜ë„ë¡ ì„¤ì •

```java
// SecurityConfig.javaì— ì¶”ê°€
.requestMatchers("/api/v1/admin/analytics/**").permitAll()
```

---

### 4. DTO í´ë˜ìŠ¤

**WeeklyAnalyticsResponse**:

```java
public class WeeklyAnalyticsResponse {
    private String week;        // "2025-W03" í˜•ì‹
    private LocalDate startDate; // ì£¼ ì‹œì‘ì¼
    private LocalDate endDate;   // ì£¼ ì¢…ë£Œì¼
    private Long count;          // í•´ë‹¹ ì£¼ì˜ ì¹´ìš´íŠ¸
    
    // getters, setters, constructor
}
```

---

## í”„ë¡ íŠ¸ì—”ë“œ êµ¬í˜„ ê³„íš

### 1. ì–´ë“œë¯¼ í˜ì´ì§€

**ìœ„ì¹˜**: `src/app/admin/analytics/page.tsx`

**êµ¬ì¡°**:

```typescript
export default function AdminAnalyticsPage() {
  return (
    <div className="container mx-auto p-6">
      <h1 className="text-3xl font-bold mb-6">ì–´ë“œë¯¼ ë¶„ì„ ëŒ€ì‹œë³´ë“œ</h1>
      
      {/* ëœë”© í˜ì´ì§€ ì ‘ì† ìˆ˜ */}
      <AnalyticsCard
        title="ëœë”© í˜ì´ì§€ ì ‘ì† ìˆ˜"
        endpoint="/api/v1/admin/analytics/landing-page-views"
      />
      
      {/* ìŠ¤íƒ€ì¼ í€´ì¦ˆ ì™„ë£Œ ìˆ˜ */}
      <AnalyticsCard
        title="ìŠ¤íƒ€ì¼ í€´ì¦ˆ ì™„ë£Œ ìˆ˜"
        endpoint="/api/v1/admin/analytics/quiz-completions"
      />
      
      {/* AI ë¶„ì„ ì™„ë£Œ ìˆ˜ */}
      <AnalyticsCard
        title="AI ìŠ¤íƒ€ì¼ ë¶„ì„ ì™„ë£Œ ìˆ˜"
        endpoint="/api/v1/admin/analytics/analysis-completions"
      />
    </div>
  );
}
```

---

### 2. AnalyticsCard ì»´í¬ë„ŒíŠ¸

**ìœ„ì¹˜**: `src/components/admin/AnalyticsCard.tsx`

**ê¸°ëŠ¥**:
- API í˜¸ì¶œí•˜ì—¬ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
- í‘œ(Table)ë¡œ ë°ì´í„° í‘œì‹œ
- ê·¸ë˜í”„(Line Chart)ë¡œ ì‹œê°í™”

**êµ¬ì¡°**:

```typescript
interface AnalyticsCardProps {
  title: string;
  endpoint: string;
}

export function AnalyticsCard({ title, endpoint }: AnalyticsCardProps) {
  const [data, setData] = useState<WeeklyAnalytics[]>([]);
  const [loading, setLoading] = useState(true);
  
  useEffect(() => {
    fetchAnalytics(endpoint).then(setData).finally(() => setLoading(false));
  }, [endpoint]);
  
  if (loading) return <LoadingSpinner />;
  
  return (
    <Card className="mb-6">
      <CardHeader>
        <CardTitle>{title}</CardTitle>
      </CardHeader>
      <CardContent>
        {/* í‘œ */}
        <AnalyticsTable data={data} />
        
        {/* ê·¸ë˜í”„ */}
        <AnalyticsChart data={data} />
      </CardContent>
    </Card>
  );
}
```

---

### 3. AnalyticsTable ì»´í¬ë„ŒíŠ¸

**ìœ„ì¹˜**: `src/components/admin/AnalyticsTable.tsx`

**ê¸°ëŠ¥**: ì£¼ë³„ ë°ì´í„°ë¥¼ í‘œë¡œ í‘œì‹œ

**ì»¬ëŸ¼**:
- ì£¼ (Week)
- ì‹œì‘ì¼
- ì¢…ë£Œì¼
- ì¹´ìš´íŠ¸

---

### 4. AnalyticsChart ì»´í¬ë„ŒíŠ¸

**ìœ„ì¹˜**: `src/components/admin/AnalyticsChart.tsx`

**ê¸°ëŠ¥**: Rechartsë¥¼ ì‚¬ìš©í•œ ë¼ì¸ ì°¨íŠ¸

**ì°¨íŠ¸ íƒ€ì…**: Line Chart

**Xì¶•**: ì£¼ (Week)
**Yì¶•**: ì¹´ìš´íŠ¸ (Count)

---

## ë°ì´í„° êµ¬ì¡°

### API ì‘ë‹µ í˜•ì‹

```json
[
  {
    "week": "2025-W03",
    "startDate": "2025-01-13",
    "endDate": "2025-01-19",
    "count": 125
  },
  {
    "week": "2025-W04",
    "startDate": "2025-01-20",
    "endDate": "2025-01-26",
    "count": 158
  }
]
```

### TypeScript íƒ€ì…

```typescript
interface WeeklyAnalytics {
  week: string;        // "2025-W03"
  startDate: string;   // "2025-01-13"
  endDate: string;     // "2025-01-19"
  count: number;       // 125
}
```

---

## êµ¬í˜„ ë‹¨ê³„

### Phase 1: ë°±ì—”ë“œ ë¡œê·¸ íŒŒì‹± (2ì¼)

**ëª©í‘œ**: LogParser í´ë˜ìŠ¤ êµ¬í˜„

- [ ] LogParser í´ë˜ìŠ¤ ìƒì„±
- [ ] ì •ê·œí‘œí˜„ì‹ íŒ¨í„´ ì •ì˜
- [ ] ë°±ì—”ë“œ ë¡œê·¸ íŒŒì‹± ë¡œì§ êµ¬í˜„
- [ ] í”„ë¡ íŠ¸ì—”ë“œ ë¡œê·¸ íŒŒì‹± ë¡œì§ êµ¬í˜„
- [ ] ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ì‘ì„±

**ì˜ˆìƒ ì‹œê°„**: 4-6ì‹œê°„

---

### Phase 2: ë°±ì—”ë“œ ì§‘ê³„ ì„œë¹„ìŠ¤ (2ì¼)

**ëª©í‘œ**: AnalyticsService êµ¬í˜„

- [ ] AnalyticsService í´ë˜ìŠ¤ ìƒì„±
- [ ] ë¡œê·¸ íŒŒì¼ ì½ê¸° ë¡œì§ êµ¬í˜„
- [ ] ëœë”© í˜ì´ì§€ ì ‘ì† ìˆ˜ ì§‘ê³„ ë¡œì§
- [ ] ìŠ¤íƒ€ì¼ í€´ì¦ˆ ì™„ë£Œ ìˆ˜ ì§‘ê³„ ë¡œì§
- [ ] AI ë¶„ì„ ì™„ë£Œ ìˆ˜ ì§‘ê³„ ë¡œì§
- [ ] ì£¼ë³„ ì§‘ê³„ ë¡œì§ êµ¬í˜„

**ì˜ˆìƒ ì‹œê°„**: 6-8ì‹œê°„

---

### Phase 3: ë°±ì—”ë“œ API ì—”ë“œí¬ì¸íŠ¸ (1ì¼)

**ëª©í‘œ**: REST API êµ¬í˜„

- [ ] AnalyticsController ìƒì„±
- [ ] 3ê°œ ì—”ë“œí¬ì¸íŠ¸ êµ¬í˜„
- [ ] DTO í´ë˜ìŠ¤ ìƒì„±
- [ ] Security ì„¤ì • (ì¸ì¦ ë¶ˆí•„ìš”)
- [ ] API í…ŒìŠ¤íŠ¸

**ì˜ˆìƒ ì‹œê°„**: 2-3ì‹œê°„

---

### Phase 4: í”„ë¡ íŠ¸ì—”ë“œ ì»´í¬ë„ŒíŠ¸ (2ì¼)

**ëª©í‘œ**: ì–´ë“œë¯¼ í˜ì´ì§€ UI êµ¬í˜„

- [ ] ì–´ë“œë¯¼ í˜ì´ì§€ ìƒì„± (`/admin/analytics`)
- [ ] AnalyticsCard ì»´í¬ë„ŒíŠ¸ êµ¬í˜„
- [ ] AnalyticsTable ì»´í¬ë„ŒíŠ¸ êµ¬í˜„
- [ ] AnalyticsChart ì»´í¬ë„ŒíŠ¸ êµ¬í˜„ (Recharts)
- [ ] API í˜¸ì¶œ ë¡œì§ êµ¬í˜„
- [ ] ë¡œë”©/ì—ëŸ¬ ìƒíƒœ ì²˜ë¦¬

**ì˜ˆìƒ ì‹œê°„**: 6-8ì‹œê°„

---

### Phase 5: í†µí•© í…ŒìŠ¤íŠ¸ (1ì¼)

**ëª©í‘œ**: ì „ì²´ í”Œë¡œìš° í…ŒìŠ¤íŠ¸

- [ ] ë°±ì—”ë“œ ë¡œê·¸ ìƒì„± í…ŒìŠ¤íŠ¸
- [ ] API ì—”ë“œí¬ì¸íŠ¸ í…ŒìŠ¤íŠ¸
- [ ] í”„ë¡ íŠ¸ì—”ë“œ UI í…ŒìŠ¤íŠ¸
- [ ] ì „ì²´ í†µí•© í…ŒìŠ¤íŠ¸

**ì˜ˆìƒ ì‹œê°„**: 2-3ì‹œê°„

---

## ë¡œê·¸ íŒŒì‹± ìƒì„¸ ì„¤ê³„

### ë°±ì—”ë“œ ë¡œê·¸ í˜•ì‹

```
2025-01-20 15:30:45.123 INFO  [01AN4Z07BY79K3] --- [http-nio-8080-exec-1] c.e.w.common.logging.ApiLogger : API Request: GET /api/v1/feature1/ping | RequestId: 01AN4Z07BY79K3
```

**ì •ê·œí‘œí˜„ì‹**:

```java
private static final Pattern BACKEND_LOG_PATTERN = Pattern.compile(
    "^(\\d{4}-\\d{2}-\\d{2} \\d{2}:\\d{2}:\\d{2}\\.\\d{3}) " +  // Group 1: timestamp
    "(INFO|DEBUG|ERROR|WARN) " +                                 // Group 2: level
    "\\[([A-Z0-9]{26})\\] " +                                    // Group 3: requestId (ULID 26ì)
    ".*?API Request: (GET|POST|PUT|DELETE|PATCH) " +            // Group 4: method
    "([^|\\s]+)" +                                                // Group 5: apiPath
    ".*?RequestId: ([A-Z0-9]{26})"                                // Group 6: requestId í™•ì¸
);
```

**íŒŒì‹± ê²°ê³¼**:

```java
ParsedLog {
  requestId: "01AN4Z07BY79K3",
  timestamp: LocalDateTime.of(2025, 1, 20, 15, 30, 45, 123000000),
  method: "GET",
  apiPath: "/api/v1/feature1/ping",
  referer: null, // ë°±ì—”ë“œ ë¡œê·¸ì—ëŠ” ì—†ìŒ
  logType: "backend"
}
```

---

### í”„ë¡ íŠ¸ì—”ë“œ ë¡œê·¸ í˜•ì‹ (ë°±ì—”ë“œë¡œ ì „ì†¡ ì‹œ)

í”„ë¡ íŠ¸ì—”ë“œ ë¡œê·¸ë¥¼ ë°±ì—”ë“œë¡œ ì „ì†¡í•˜ëŠ” ê²½ìš°ë¥¼ ëŒ€ë¹„í•œ íŒ¨í„´:

```
[2025-01-20T15:30:45.123Z][FE][INFO][Feature1] REQUEST_START { "requestId": "550e8400-e29b-41d4-a716-446655440000", "url": "https://api.example.com/api/v1/feature1/ping" }
```

**ì •ê·œí‘œí˜„ì‹**:

```java
private static final Pattern FRONTEND_LOG_PATTERN = Pattern.compile(
    "\\[([^]]+)\\]" +                                             // Group 1: timestamp
    "\\[FE\\]" +
    "\\[([^]]+)\\]" +                                             // Group 2: level
    "\\[([^]]+)\\]" +                                             // Group 3: scope
    " ([A-Z_]+)" +                                                // Group 4: event
    ".*?\"requestId\"[:\"\\s]+([A-Za-z0-9-]+)" +                 // Group 5: requestId
    ".*?\"url\"[:\"\\s]+([^\\s}]+)"                              // Group 6: url
);
```

---

### ëœë”© í˜ì´ì§€ ì ‘ì† ìˆ˜ ì§‘ê³„ ë¡œì§

**í•„í„°ë§ ì¡°ê±´**:
1. í”„ë¡ íŠ¸ì—”ë“œ ë¡œê·¸: `event = "page_view"` AND `apiPath = "/"` ë˜ëŠ” `referer = "/"`
2. ë°±ì—”ë“œ ë¡œê·¸: `apiPath = "/"` (ë˜ëŠ” ëœë”© í˜ì´ì§€ ê´€ë ¨ API)

**ì§‘ê³„ ë°©ë²•**:
- ì£¼(Week) ë‹¨ìœ„ë¡œ ê·¸ë£¹í™”
- ISO 8601 ì£¼ í˜•ì‹ ì‚¬ìš©: `2025-W03`

---

### ìŠ¤íƒ€ì¼ í€´ì¦ˆ ì™„ë£Œ ìˆ˜ ì§‘ê³„ ë¡œì§

**í•„í„°ë§ ì¡°ê±´**:
1. í”„ë¡ íŠ¸ì—”ë“œ ë¡œê·¸: `event = "quiz_complete"`
2. ë°±ì—”ë“œ ë¡œê·¸: `apiPath = "/api/v1/style-quiz/complete"` (ë˜ëŠ” ê´€ë ¨ API)

---

### AI ë¶„ì„ ì™„ë£Œ ìˆ˜ ì§‘ê³„ ë¡œì§

**í•„í„°ë§ ì¡°ê±´**:
1. í”„ë¡ íŠ¸ì—”ë“œ ë¡œê·¸: `event = "result_generated"` AND `has_error = false`
2. ë°±ì—”ë“œ ë¡œê·¸: `apiPath = "/api/v1/style-quiz/result"` (ë˜ëŠ” ê´€ë ¨ API)

---

## ì„±ëŠ¥ ìµœì í™”

### ë¡œê·¸ íŒŒì¼ ì½ê¸° ìµœì í™”

1. **ìµœê·¼ Nì¼ë§Œ ì½ê¸°**: ê¸°ë³¸ê°’ 90ì¼ (ì•½ 12ì£¼)
2. **ì—­ìˆœ ì½ê¸°**: ìµœì‹  ë¡œê·¸ë¶€í„° ì½ê¸° (í•„ìš”í•œ ê¸°ê°„ë§Œ ì½ìœ¼ë©´ ì¤‘ë‹¨)
3. **ìºì‹±**: ê°™ì€ ìš”ì²­ì— ëŒ€í•´ ì§§ì€ ì‹œê°„(5ë¶„) ìºì‹œ

```java
@Cacheable(value = "analytics", key = "#endpoint + '_' + #weeks")
public List<WeeklyAnalytics> getAnalytics(String endpoint, int weeks) {
    // ì§‘ê³„ ë¡œì§
}
```

---

## ì—ëŸ¬ ì²˜ë¦¬

### ë¡œê·¸ íŒŒì¼ì´ ì—†ëŠ” ê²½ìš°

```java
if (!logFile.exists()) {
    log.warn("Log file not found: {}", logFile.getPath());
    return Collections.emptyList();
}
```

### ë¡œê·¸ íŒŒì¼ ì½ê¸° ì‹¤íŒ¨

```java
try {
    return Files.readAllLines(logFile.toPath());
} catch (IOException e) {
    log.error("Failed to read log file: {}", e.getMessage());
    throw new AnalyticsException("Failed to read log file", e);
}
```

### íŒŒì‹± ì‹¤íŒ¨

```java
ParsedLog parsed = LogParser.parse(logLine);
if (parsed == null) {
    // íŒŒì‹± ì‹¤íŒ¨í•œ ë¡œê·¸ëŠ” ë¬´ì‹œí•˜ê³  ê³„ì† ì§„í–‰
    continue;
}
```

---

## ë³´ì•ˆ ê³ ë ¤ì‚¬í•­

### ì¸ì¦ ì—†ì´ ì ‘ê·¼ ê°€ëŠ¥

- **ìœ„í—˜ë„**: ë‚®ìŒ (í†µê³„ ë°ì´í„°ë§Œ ì œê³µ)
- **ëŒ€ì‘**: ë¯¼ê°í•œ ì •ë³´(ì‚¬ìš©ì ID, ê°œì¸ì •ë³´ ë“±)ëŠ” ë¡œê·¸ì— í¬í•¨í•˜ì§€ ì•ŠìŒ

### í–¥í›„ ê°œì„ 

- IP í™”ì´íŠ¸ë¦¬ìŠ¤íŠ¸
- API í‚¤ ê¸°ë°˜ ì¸ì¦
- Rate Limiting

---

## í…ŒìŠ¤íŠ¸ ê³„íš

### ë‹¨ìœ„ í…ŒìŠ¤íŠ¸

1. **LogParser í…ŒìŠ¤íŠ¸**
   - ë°±ì—”ë“œ ë¡œê·¸ íŒŒì‹± í…ŒìŠ¤íŠ¸
   - í”„ë¡ íŠ¸ì—”ë“œ ë¡œê·¸ íŒŒì‹± í…ŒìŠ¤íŠ¸
   - ì˜ëª»ëœ í˜•ì‹ ë¡œê·¸ ì²˜ë¦¬ í…ŒìŠ¤íŠ¸

2. **AnalyticsService í…ŒìŠ¤íŠ¸**
   - ë¡œê·¸ íŒŒì¼ ì½ê¸° í…ŒìŠ¤íŠ¸
   - ì§‘ê³„ ë¡œì§ í…ŒìŠ¤íŠ¸
   - ì£¼ë³„ ê·¸ë£¹í™” í…ŒìŠ¤íŠ¸

### í†µí•© í…ŒìŠ¤íŠ¸

1. **API ì—”ë“œí¬ì¸íŠ¸ í…ŒìŠ¤íŠ¸**
   - ê° ì—”ë“œí¬ì¸íŠ¸ ì‘ë‹µ í…ŒìŠ¤íŠ¸
   - ì—ëŸ¬ ì¼€ì´ìŠ¤ í…ŒìŠ¤íŠ¸

2. **ì „ì²´ í”Œë¡œìš° í…ŒìŠ¤íŠ¸**
   - ë¡œê·¸ ìƒì„± â†’ íŒŒì‹± â†’ ì§‘ê³„ â†’ API ì‘ë‹µ â†’ í”„ë¡ íŠ¸ì—”ë“œ í‘œì‹œ

---

## ì°¸ê³  ìë£Œ

- [Logback ê³µì‹ ë¬¸ì„œ](https://logback.qos.ch/)
- [Java ì •ê·œí‘œí˜„ì‹ ê°€ì´ë“œ](https://docs.oracle.com/javase/8/docs/api/java/util/regex/Pattern.html)
- [Recharts ê³µì‹ ë¬¸ì„œ](https://recharts.org/)
- [ISO 8601 ì£¼ í˜•ì‹](https://en.wikipedia.org/wiki/ISO_8601#Week_dates)

---

## ì—…ë°ì´íŠ¸ ì´ë ¥

- 2025-01-XX: ì´ˆê¸° ì‘ì„±
  - ìš”êµ¬ì‚¬í•­ ë¶„ì„ ì™„ë£Œ
  - ì•„í‚¤í…ì²˜ ì„¤ê³„ ì™„ë£Œ
  - êµ¬í˜„ ê³„íš ìˆ˜ë¦½ ì™„ë£Œ
